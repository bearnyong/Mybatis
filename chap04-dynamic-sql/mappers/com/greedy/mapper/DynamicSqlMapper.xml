<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.greedy.mapper.DynamicSqlMapper">

  <resultMap type="com.greedy.dto.MenuDTO" id="menuResultMap">
  	<id property="menuCode" column="MENU_CODE"/>
  	<result property="menuName" column="MENU_NAME"/>
  	<result property="menuPrice" column="MENU_PRICE"/>
  	<result property="categoryCode" column="CATEGORY_CODE"/>
  	<result property="status" column="ORDERABLE_STATUS"/>
  </resultMap>
	
  <select id="selectMenuByPrice" parameterType="hashmap" resultMap="menuResultMap">
    SELECT
    	   MENU_CODE,
    	   MENU_NAME,
    	   MENU_PRICE,
    	   CATEGORY_CODE,
    	   ORDERABLE_STATUS
      FROM TBL_MENU
     WHERE ORDERABLE_STATUS = 'Y'
     <!-- 동적쿼리 : 사용자의 입력 값에 따라 결과가 달라진다.
     	    아래 두 if문 중 price 값이 포함되는 쿼리가 WHERE 조건에 추가된다. -->
     <!-- test(조건식) : price가 0보다 크고(price gte 0) 10000보다 작은 값(price lte 10000)...-->
     <if test="price gte 0 and price lte 10000">
     <!-- CDATA를 통해 꺽새로 인식 가능하도록 한다. -->
     <![CDATA[
     	AND MENU_PRICE < #{price}
     ]]>
     </if>
     <if test="price gt 10000 and price lte 20000">
     	AND MENU_PRICE BETWEEN 10000 AND #{price}
     </if>
     <if test="price gt 20000 and price lte 30000">
     	AND MENU_PRICE BETWEEN 20000 AND #{price}
     </if>
     <if test="price gt 30000">
     	AND MENU_PRICE BETWEEN 30000 AND #{price}
     </if>
     ORDER BY MENU_CODE
  </select>
  
</mapper>